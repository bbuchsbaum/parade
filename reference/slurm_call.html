<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Submit an R function to SLURM — slurm_call • parade</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Submit an R function to SLURM — slurm_call"><meta name="description" content="Submits an R function as a SLURM job by serializing the function and its
arguments, then executing them on the compute node. This provides an
ergonomic interface for running functions on SLURM without creating
explicit script files."><meta property="og:description" content="Submits an R function as a SLURM job by serializing the function and its
arguments, then executing them on the compute node. This provides an
ergonomic interface for running functions on SLURM without creating
explicit script files."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parade</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Submit an R function to SLURM</h1>

      <div class="d-none name"><code>slurm_call.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Submits an R function as a SLURM job by serializing the function and its
arguments, then executing them on the compute node. This provides an
ergonomic interface for running functions on SLURM without creating
explicit script files.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">slurm_call</span><span class="op">(</span></span>
<span>  <span class="va">.f</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  name_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  resources <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  registry_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  env <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  lib_paths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/libPaths.html" class="external-link">.libPaths</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rscript <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Rhome.html" class="external-link">R.home</a></span><span class="op">(</span><span class="st">"bin"</span><span class="op">)</span>, <span class="st">"Rscript"</span><span class="op">)</span>,</span>
<span>  write_result <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  engine <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"slurm"</span>, <span class="st">"local"</span><span class="op">)</span>,</span>
<span>  .as_jobset <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .error_policy <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--f">.f<a class="anchor" aria-label="anchor" href="#arg--f"></a></dt>
<dd><p>Function to execute on SLURM</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments to pass to the function</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>Optional job name (defaults to "slurm-call")</p></dd>


<dt id="arg-name-by">name_by<a class="anchor" aria-label="anchor" href="#arg-name-by"></a></dt>
<dd><p>Function or string for dynamic job naming. Can be "stem", "index",
"digest", or a function that takes the arguments and returns a string</p></dd>


<dt id="arg-packages">packages<a class="anchor" aria-label="anchor" href="#arg-packages"></a></dt>
<dd><p>Character vector of packages to load on the compute node</p></dd>


<dt id="arg-resources">resources<a class="anchor" aria-label="anchor" href="#arg-resources"></a></dt>
<dd><p>Named list of SLURM resource specifications</p></dd>


<dt id="arg-template">template<a class="anchor" aria-label="anchor" href="#arg-template"></a></dt>
<dd><p>Path to SLURM template file (uses default if NULL)</p></dd>


<dt id="arg-registry-dir">registry_dir<a class="anchor" aria-label="anchor" href="#arg-registry-dir"></a></dt>
<dd><p>Directory for batchtools registry (auto-generated if NULL)</p></dd>


<dt id="arg-env">env<a class="anchor" aria-label="anchor" href="#arg-env"></a></dt>
<dd><p>Named character vector of environment variables to set</p></dd>


<dt id="arg-lib-paths">lib_paths<a class="anchor" aria-label="anchor" href="#arg-lib-paths"></a></dt>
<dd><p>Character vector of library paths to use</p></dd>


<dt id="arg-rscript">rscript<a class="anchor" aria-label="anchor" href="#arg-rscript"></a></dt>
<dd><p>Path to Rscript executable</p></dd>


<dt id="arg-write-result">write_result<a class="anchor" aria-label="anchor" href="#arg-write-result"></a></dt>
<dd><p>Optional path to save function result (e.g., "artifacts://result.rds")</p></dd>


<dt id="arg-engine">engine<a class="anchor" aria-label="anchor" href="#arg-engine"></a></dt>
<dd><p>Execution engine: "slurm" (default) or "local" for debugging</p></dd>


<dt id="arg--as-jobset">.as_jobset<a class="anchor" aria-label="anchor" href="#arg--as-jobset"></a></dt>
<dd><p>Logical indicating whether to return a single-element jobset
instead of a bare job object. Defaults to FALSE for backward compatibility.</p></dd>


<dt id="arg--error-policy">.error_policy<a class="anchor" aria-label="anchor" href="#arg--error-policy"></a></dt>
<dd><p>Error handling policy from <code><a href="on_error.html">on_error()</a></code>. Specifies how
to handle job failures, including retry logic and backoff strategies.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>parade_script_job</code> object for monitoring the job, or a
<code>parade_jobset</code> containing the job if <code>.as_jobset = TRUE</code>. If <code>write_result</code>
is specified, the job object will include a <code>result_path</code> attribute with
the resolved path where the result will be saved.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function works by:</p><ol><li><p>Serializing the function and arguments to RDS files</p></li>
<li><p>Creating a small runner script that loads and executes them</p></li>
<li><p>Submitting the runner script via <code><a href="submit_slurm.html">submit_slurm()</a></code></p></li>
</ol><p>The function and its arguments are serialized using <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code>, which will
include the function's closure environment. Be aware that large objects
captured in the closure can significantly increase serialization size.</p>
<p>Packages specified in the <code>packages</code> argument will be loaded on the compute
node before executing the function. If your function depends on packages,
either specify them here or call <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> within the function itself.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="submit_slurm.html">submit_slurm</a></code> for submitting script files,
<code><a href="script_status.html">script_status</a></code> for monitoring job status,
<code><a href="script_await.html">script_await</a></code> for waiting for completion</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Local execution example (no SLURM required)</span></span></span>
<span class="r-in"><span><span class="va">local_job</span> <span class="op">&lt;-</span> <span class="fu">slurm_call</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  engine <span class="op">=</span> <span class="st">"local"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Returns result immediately</span></span></span>
<span class="r-in"><span><span class="va">local_job</span><span class="op">$</span><span class="va">result</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Note: The following examples require a SLURM cluster environment</span></span></span>
<span class="r-in"><span><span class="co"># Simple function submission</span></span></span>
<span class="r-in"><span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu">slurm_call</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">"square-10"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No readable configuration file found</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created registry in '/tmp/RtmpRBH8lf/parade-registry/script-7e9c4c46' using cluster functions 'Interactive'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding 1 jobs ...</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> Listing of jobs failed (exit code 127);</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> cmd: 'squeue --user=$USER --states=R,S,CG,RS,SI,SO,ST --noheader --format=%i -r'</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> output:</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> command not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With packages and result saving</span></span></span>
<span class="r-in"><span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu">slurm_call</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>  packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stats"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  write_result <span class="op">=</span> <span class="st">"artifacts://random_matrix.rds"</span>,</span></span>
<span class="r-in"><span>  resources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mem <span class="op">=</span> <span class="st">"8G"</span>, time <span class="op">=</span> <span class="st">"10min"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No readable configuration file found</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created registry in '/tmp/RtmpRBH8lf/parade-registry/script-1a3c4d9e' using cluster functions 'Interactive'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding 1 jobs ...</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> Listing of jobs failed (exit code 127);</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> cmd: 'squeue --user=$USER --states=R,S,CG,RS,SI,SO,ST --noheader --format=%i -r'</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> output:</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> command not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Monitor the job</span></span></span>
<span class="r-in"><span><span class="fu"><a href="script_tail.html">script_tail</a></span><span class="op">(</span><span class="va">job</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'job' not found</span>
<span class="r-in"><span><span class="fu"><a href="script_await.html">script_await</a></span><span class="op">(</span><span class="va">job</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'job' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load saved result</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">job</span><span class="op">$</span><span class="va">result_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">job</span><span class="op">$</span><span class="va">result_path</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'job' not found</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Parade Authors.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

