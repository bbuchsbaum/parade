% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/flow.R
\name{stage}
\alias{stage}
\title{Add a processing stage to a parade flow}
\usage{
stage(
  fl,
  id,
  f,
  needs = character(),
  schema,
  prefix = TRUE,
  sink = NULL,
  skip_when = NULL,
  hoist_struct = FALSE,
  ...
)
}
\arguments{
\item{fl}{A \code{parade_flow} object}

\item{id}{Unique stage identifier (character)}

\item{f}{Function to execute for this stage}

\item{needs}{Character vector of stage IDs this stage depends on}

\item{schema}{Schema defining expected output structure (from \code{returns()})}

\item{prefix}{Whether to prefix output columns with stage ID (logical)}

\item{sink}{Optional sink specification for artifact persistence}

\item{skip_when}{Optional function to determine when to skip this stage}

\item{hoist_struct}{Whether to hoist nested data structures (logical)}

\item{...}{Additional constant arguments passed to the stage function}
}
\value{
The input flow with the new stage added
}
\description{
A stage defines a computational step in the flow with typed inputs and
outputs, optional dependencies, and configurable data handling options.
}
\examples{
grid <- data.frame(x = 1:3)
fl <- flow(grid) |>
  stage("double", function(x) x * 2, schema = returns(result = dbl()))
}
